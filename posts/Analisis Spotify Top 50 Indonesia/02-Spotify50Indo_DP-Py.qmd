---
title: "Analisis Spotify Top 50 Indonesia  - Pemrosesan Data"
format: 
  html: 
    df-print: paged
description: |
  Memahami penggunaan Spotify saya selama tahun 2022, dan tahun-tahun sebelumnya.
author: "Alif Dewantara"
title-block-banner: true
date: "2023-03-17"
categories: 
  - Analisis Data
  - Python
  - Musik
comments: 
  utterances: 
    repo: quarto-dev/quarto-web
    theme: github-light
    issue-term: title
image: "spotify2022.png"
---

# Bab 2, Data Pre-Processing

```{python impor_modul}
# Mengimpor modul
import pandas as pd
import re
from afinn import Afinn
from nrclex import NRCLex
```

```{python load_data}
lyrics = pd.read_csv('datasets/lirik_top50_gsheet.csv')
audio = pd.read_csv('datasets/audio_features.csv')
lyrics.shape, audio.shape
```

```{python create_df}
lyrics['lang'].value_counts()
```

```{python add_words_col}
df = lyrics.copy()
df['lyrics'] = [re.sub(r'^.*?Lyrics', '', str(lyric)) for lyric in df['lyrics']]
df['cleaned_lyrics'] = [str(lyric).replace('\n',' ') for lyric in df['lyrics']]
df['cleaned_lyrics'] = [re.sub("\[.*?\]","",lyric) for lyric in df['cleaned_lyrics']]

df['title_length'] = [len(title) for title in df['track']]
df['lines'] = [str(lyric).count('\n') for lyric in df['lyrics']]
df['sections'] = [str(lyric).count('\n\n') for lyric in df['lyrics']]
df['words'] = [len(str(lyric).split()) for lyric in df['cleaned_lyrics']]
df['unique_words'] = [len(set(str(lyric).split())) for lyric in df['cleaned_lyrics']]

df.head(3)
```

## NRCLex

```{python add_emot}
df['emot_positive'] = [NRCLex(lyric).affect_frequencies.get('positive') for lyric in df['translated']]
df['emot_negative'] = [NRCLex(lyric).affect_frequencies.get('negative') for lyric in df['translated']]
df['emot_anger'] = [NRCLex(lyric).affect_frequencies.get('anger') for lyric in df['translated']]
df['emot_trust'] = [NRCLex(lyric).affect_frequencies.get('trust') for lyric in df['translated']]
df['emot_disgust'] = [NRCLex(lyric).affect_frequencies.get('disgust') for lyric in df['translated']]
df['emot_fear'] = [NRCLex(lyric).affect_frequencies.get('fear') for lyric in df['translated']]
df['emot_joy'] = [NRCLex(lyric).affect_frequencies.get('joy') for lyric in df['translated']]
df['emot_surprise'] = [NRCLex(lyric).affect_frequencies.get('surprise') for lyric in df['translated']]
df['emot_anticp'] = [NRCLex(lyric).affect_frequencies.get('anticip') for lyric in df['translated']]
```

```{python df_head}
df.head(5)
```

```{python save_df}
# Menyimpan analisis NRCLex
df.to_csv('datasets/data_lyrics.csv')
```
